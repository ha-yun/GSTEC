# 2ì£¼ì°¨
## <1>
* ì¥ìˆœìš© ê°•ì‚¬ë‹˜

<ìê²©ì¦>
* êµ­ê°€ê³µì¸ SQLê°œë°œì
* êµ­ê°€ê³µì¸ ë°ì´í„°ë¶„ì„ ì¤€ì „ë¬¸ê°€

<ëŒ€íšŒ>
* ìºê¸€
* jweek.or.kr
* DACON

##### ë°ì´í„° ë² ì´ìŠ¤ì˜ êµ¬ì¡°ì  íŠ¹ì§•
1. í†µí•©ì„±(integrated) : ë™ì¼ ë°ì´í„°ê°€ ì¤‘ë³µë˜ì§€ ì•ŠìŒ.  
2. ì €ì¥ë¨(stored) : ì»´í“¨í„° ê¸°ìˆ ì„ ë°”íƒ•ìœ¼ë¡œ ì €ì¥ ë§¤ì²´ì— ì €ì¥ë¨  
3. ê³µìš©ì„±(shared) : ì—¬ëŸ¬ ì‚¬ìš©ìê°€ ë‹¤ì–‘í•œ ëª©ì ìœ¼ë¡œ ì‚¬ìš©í•  ìˆ˜ ìˆìŒ  
4. ë³€í™”ì„±(changeable) : ìƒˆë¡œìš´ ë°ì´í„°ì˜ ì‚½ì…, ê¸°ì¡´ ë°ì´í„°ì˜ ì‚­ì œ ë° ë³€ê²½ ê°€ëŠ¥

#### ë°ì´í„° ë² ì´ìŠ¤ì˜ ì¢…ë¥˜
1. ê³„ì¸µí˜• DB : íŠ¸ë¦¬ êµ¬ì¡°ë¥¼ ì´ìš©í•´ì„œ ìƒí˜¸ ê´€ê³„ë¥¼ ê³„ì¸µì ìœ¼ë¡œ ì •ì˜í•¨.  
2. ë„¤íŠ¸ì›Œí¬í˜• DB : ê·¸ë˜í”„ êµ¬ì¡°ë¥¼ ì´ìš©í•´ì„œ ìƒí˜¸ ê´€ê³„ë¥¼ ê³„ì¸µì ìœ¼ë¡œ ì •ì˜í•¨.  
3. ê´€ê³„í˜• DB : ê³„ì¸µí˜•ê³¼ ë„¤íŠ¸ì›Œí¬í˜•ì˜ ë³µì¡í•œ êµ¬ì¡°ë¥¼ ë‹¨ìˆœí™” ì‹œí‚¨ ëª¨ë¸. ë‹¨ìˆœí•œ í‘œ(table)ë¥¼ ì´ìš©í•˜ì—¬ ë°ì´í„°ì˜ ìƒí˜¸ê´€ê³„ë¥¼ ì •ì˜í•¨.  
4. ê°ì²´ ì§€í–¥í˜• DB : ê°ì²´ì˜ ê°œë… ë„ì…. ë©€í‹°ë¯¸ë””ì–´ì™€ ê°™ì´ ë³µì¡í•œ ê´€ê³„ë¥¼ ê°€ì§„ ë°ì´í„°ë¥¼ í‘œí˜„í•˜ëŠ”ë° íš¨ê³¼ì ì„.

#### SQL(Structured Query Language)
1. ë°ì´í„° ì •ì˜(DDL) : ë°ì´í„° ë² ì´ìŠ¤ë¥¼ ì •ì˜, ìƒì„±, ë³€ê²½, ì‚­ì œí•˜ëŠ” ê²ƒ.  
2. ë°ì´í„° ì¡°ì‘(DML) : ì§ˆì˜(query)ë¥¼ í†µí•´ì„œ ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ê³  ì²˜ë¦¬ í•˜ëŠ” ê²ƒ.  
3. ë°ì´í„° ì œì–´(DCL) : ë°ì´í„°ì˜ ë³´ì•ˆ, ë¬´ê²°ì„±, ë³‘í–‰ ìˆ˜í–‰ ì œì–´ ë“±ì„ í•˜ëŠ” ê²ƒ

* ê²½ëŸ‰ ë°ì´í„° ë² ì´ìŠ¤ : SQLite(1ì¸ ì‚¬ìš©ì ì „ì œ)  
* ë°ì´í„° ë² ì´ìŠ¤ ì„œë²„ êµ¬ì¶•ìš© : MySQL(ë‹¤ìˆ˜ì˜ ì‚¬ìš©ì ì „ì œ)

#### ë°ì´í„° ë² ì´ìŠ¤ì˜ í™œìš© : CRM, SCM, ERP, BI, KMS  
* ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ì—¬ëŸ¬ í…Œì´ë¸”ë¡œ ë¶„ì‚°í•´ ë†“ìœ¼ë©´ íš¨ìœ¨ì ì´ë‹¤.

```sqlite
-- -- ìš°ë¦¬ëŠ” SQLite ì‚¬ìš©
-- SQLê³¼ ë°ì´í„°ë² ì´ìŠ¤
-- SQL ê¸°ì´ˆ ë¬¸ë²• : í–‰ ê°€ì ¸ì˜¤ê¸°
-- #SQLì€ ëŒ€ì†Œë¬¸ìë¥¼ êµ¬ë¶„í•˜ì§€ ì•ŠëŠ”ë‹¤.
SELECT'Hello, World';   --ë¬¸ìì—´ ì¶œë ¥
SELECT 1+2; --ê°„ë‹¨í•œ ì—°ì‚°
SELECT *FROM Country; --'Country'ë¼ëŠ” ì´ë¦„ì˜ í…Œì´ë¸” ì¶œë ¥
SELECT *FROM Country ORDER BY Name; --Nameìœ¼ë¡œ ì •ë ¬
SELECT Name,LifeExpectancy AS 'LIFE' FROM Country; --Nameì¶œë ¥ê³¼ LIfeëŠ”ì´ë¦„ ë°”ê¿”ì„œ ì¶œë ¥

SELECT COUNT(*) FROM Country;   --í–‰ìˆ˜ ì¹´ìš´íŒ…
--count()í•¨ìˆ˜ë¡œ *ëŠ” ëª¨ë“  ê°’ì„ ì˜ë¯¸, ë³€ìˆ˜ë¥¼ ë„£ì–´ë„ ëœë‹¤.
SELECT *FROM Country ORDER BY Name LIMIT 5; --ì¶œë ¥ìˆ˜ ì œí•œ
SELECT *FROM Country ORDER BY Name LIMIT 5 OFFSET 5; --ì²˜ìŒ 5ê°œë¥¼ ê±´ë„ˆë›°ê³  ì œí•œëœ 5ê°œì˜ ê°’ ì¶œë ¥
```
<hr>

## <2>
```sqlite
--íŠ¹ì • ì»¬ëŸ¼ ê°€ì ¸ì˜¤ê¸°
SELECT*FROM Country ORDER BY Code; 
SELECT Name, Code, Region, Population FROM Country ORDER BY Code;  
SELECT Name, Code, Region, Population FROM Country ORDER BY Population DESC;  --DESCëŠ” ë‚´ë¦¼ì°¨ìˆœ
SELECT Name AS Country,Code FROM Country ORDER BY Code;   --ì»¬ëŸ¼ì„ ë¶ˆëŸ¬ì™€ì„œ ì´ë¦„ì„ ë³€ê²½í•˜ì—¬ ì¶œë ¥í•  ìˆ˜ ìˆë‹¤.
SELECT Name AS Coutry,Population/1000 AS "Pop(1000s)"FROM Coutry; --ê°„ë‹¨í•œ ìˆ˜ì‹ì„ ì ìš©í•  ìˆ˜ë„ ìˆë‹¤.

--SELECT + ORDER BYë¥¼ ì‚¬ìš©í•´ì„œ ì •ë ¬ëœ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤„ ìˆ˜ ìˆë‹¤.
SELECT Name FROM Country; --ì •ë ¬x
SELECT Name FROM Country ORDER BY Name; --ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬ default
SELECT Name FROM Country ORDER BY Name DESC; --ë‚´ë¦¼ì°¨ìˆœ ì •ë ¬
SELECT Name FROM Country ORDER BY NAme ASC;  --ì˜¤ë¦„ì°¨ìˆœ ì •ë ¬
SELECT Name,Continent FROM Country ORDER BY Continent,Naem; --ë‘ ê°œ ì´ìƒì˜ ì»¬ëŸ¼ìœ¼ë¡œ ì •ë ¬
SELECT Name,Continent FROM Country ORDER BY Continent DESC, Name; --ë¨¼ì € ë‚˜ì˜¤ëŠ” ì»¬ëŸ¼ì„ ìš°ì„ í•´ì„œ ì •ë ¬

--SELECT + WHEREë¥¼ ì‚¬ìš©í•´ì„œ í•„í„°ë§ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤„ ìˆ˜ ìˆë‹¤.
--AND, OR ë“±ìœ¼ë¡œ ì¡°ê±´ë¬¸ì„ ì—°ê²°í•  ìˆ˜ ìˆë‹¤.
--BETWEEN n1 AND n2 ë¡œ n1~n2ë¡œ ë ˆì¸ì§€ì— ì†í•˜ëŠ” ê°’ë§Œ í•„í„°ë§ í•  ìˆ˜ ìˆë‹¤.
SELECT Name, Continent, Population FROM Country WHERE Population <100000 ORDER BY Population DESC;
SELECT Name, Continent, Population FROM Country WHERE Population < 100000 AND Continent = 'Oceania' ORDER BY Population DESC;
SELECT Name, Population FROM Country WHERE Population BETWEEN 1000000 AND 10000000 ORDER BY Population DESC;
SELECT Name, Population FROM Country WHERE Population NOT BETWEEN 1000000 AND 10000000 ORDER BY Population DESC;

--SELECT + WHERE + LIKEì„ ì‚¬ìš©í•´ì„œ í•„í„°ë§ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤„ ìˆ˜ ìˆë‹¤.
--'%'ëŠ” ë¶ˆíŠ¹ì • ë¬¸ìì—´ ë¶€ë¶„ì„ ì˜ë¯¸í•˜ê³  '_'ëŠ” ë¶ˆíŠ¹ì • ë¬¸ìë¥¼ ì˜ë¯¸í•œë‹¤.
SELECT Name,Continent FROM Country WHERE Name LIKE '%island';
SELECT Name,Continent FROM Country WHERE Name LIKE 'island%';
SELECT Name,Continent FROM Country WHERE Name LIKE '%island%';
SELECT Name,Continent FROM Country WHERE Name LIKE '_a%';   --ë‘ë²ˆì§¸ ë¬¸ìê°€ 'a'

--SELECT + WHERE + INì„ ì‚¬ìš©í•´ì„œ ë©¤ë²„ì‰½ í•„í„°ë§ ê²°ê³¼ë¥¼ ë³´ì—¬ì¤„ ìˆ˜ ìˆë‹¤.
SELECT Name,Continent FROM Country WHERE Continent IN ('Europe','Asia');
SELECT Name,Continent,Region FROM Country WHERE Region IN ('Western Europe','Eastern Europe') ORDER BY Region;
SELECT Name,Continent,Region FROM Country WHERE Region='Western Europe' OR Region='Eastern Europe' ORDER BY Region; 

--DISTINCT í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•´ì„œ ì¤‘ë³µì„ ì œê±°í•˜ê³  ì¶œë ¥í•  ìˆ˜ ìˆë‹¤.
SELECT CountryCode, Name FROM City;
SELECT DISTINCT CountryCode FROM City;
SELECT COUNT(CountryCode)FROM City;
SELECT COUNT(DISTINCT CountryCode) FROM City;

--SELECTë¡œ ì¶œë ¥ëœ ê²°ê³¼ë¥¼ "ê°€ìƒ"ì˜ í…Œì´ë¸”ë¡œ ì‚¬ìš©í•˜ì—¬ SELECT ë¬¸ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤. 
SELECT Name FROM (SELECT Code, Name, Continent FROM Country);
SELECT COUNT(*) FROM (SELECT DISTINCT CountryCode FROM City);

```

```sqlite
--CREATE TABLEë¡œ ë°ì´í„° ë² ì´ìŠ¤ì— í…Œì´ë¸”ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤. 
CREATE TABLE test (a INT, b TEXT, c TEXT);   --'a','b','c'ì»¬ëŸ¼ì˜ í…Œì´ë¸” ìƒì„±
CREATE TABLE IF NOT EXISTS test (a INT,b TEXT, c TEXT);     --'a','b','c'ì»¬ëŸ¼ì˜ í…Œì´ë¸” ì¤‘ë³µ ì²´í¬ í›„ ìƒì„±
SELECT name FROM sqlite_master WHERE TYPE ='table'  --í…Œì´ë¸” ëª©ë¡(SQLite)
PRAGMA table_info(test);  --íŠ¹ì • í…Œì´ë¸”ì— ëŒ€í•œ ì •ë³´

--INSERT INTO ~ VALUESë¡œ í–‰ì„ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤.
INSERT INTO test VALUES (1, 'This','Right here!'); --1í–‰ ì¶”ê°€
INSERT INTO test (b,c) VALUES ('That','Over there!'); --'a'ëŠ” NULL , bì™€ cì— valuesì¶”ê°€
SELECT *FROM test;
--ë‹¤ë¥¸ í…Œì´ë¸”ì—ì„œ SELECTë¡œ ê°€ì ¸ì˜¨ ê²°ê³¼ë¡œ í–‰ ì¶”ê°€ ê°€ëŠ¥í•˜ë‹¤.
INSERT INTO test(a,b,c) SELECT id,name,description FROM item; --'item'í…Œì´ë¸”ì—ì„œ ê°€ì ¸ì˜¨ ê²°ê³¼ë¥¼ testì— ì¶”ê°€

--UPDATE + SETë¡œ íŠ¹ì • í–‰ì˜ íŠ¹ì • ì»¬ëŸ¼ ê°’ì„ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.
UPDATE test SET c='Extra funny.' WHERE a=2;    --'c'ì»¬ëŸ¼ì˜ ê°’ ë³€ê²½
SELECT*FROM test;
UPDATE test SET c=NULL WHERE a=2;  --NULLê°’ìœ¼ë¡œ ë³€ê²½
UPDATE test SET(b,c)=('T-Rex','Toy dinosaur')WHERE a=2;   --ê°’ ë³€ê²½

--DELETE FROMìœ¼ë¡œ íŠ¹ì • í–‰ì„ ì‚­ì œí•  ìˆ˜ ìˆë”°.
DELETE FROM test WHERE a=2;     --ì¡°ê±´ì— ë§ëŠ” í–‰ ì‚­ì œ
DELETE FROM test;   --ëª¨ë“  í–‰ ì‚­ì œ , í…Œì´ë¸”ì€ ë‚¨ìŒ

--DROP TABLEë¡œ íŠ¹ì • í…Œì´ë¸”ì„ ì‚­ì œí•  ìˆ˜ ìˆë‹¤.
DROP TABLE test; --ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ 'test'í…Œì´ë¸” ì‚­ì œ
DROP TABLE IF EXISTS test; --ì¡´ì¬ì—¬ë¶€ í™•ì¸í•˜ê³  ë°ì´í„° ë² ì´ìŠ¤ì—ì„œ 'test'í…Œì´ë¸” ì‚­ì œ

--NULLì€ ê°’ì´ ì•„ë‹ˆë¼ ê²°ì¸¡ì¹˜ë¥¼ ì˜ë¯¸í•˜ì—¬ 0 ë˜ëŠ” ''(ê³µë°±)ê³¼ëŠ” ë‹¤ë¥´ë‹¤.
CREATE TABLE test (a INT, b TEXT, c TEXT);
INSERT INTO test(b,c) VALUES ('This','That');  --'a'ì—ëŠ” NULLì„ ë„£ì–´ì¤Œ
SELECT *FROM test WHERE a=NULL; --ì‘ë™ ì•ˆí•¨
SELECT*FROM test WHERE a IS NULL; --ì‘ë™í•¨
SELECT*FROM test WHERE a IS NOT NULL; --ì‘ë™í•¨
UPDATE test SET a=0 WHERE a IS NULL; --'a'ì»¬ëŸ¼ì˜ NULLì„ 0ê°’ìœ¼ë¡œ ì±„ì›Œ ë„£ìŒ.

```
<hr>

## <3>
* CRUD - Create, Read, Update, Delete
```sqlite
--ROUNDí•¨ìˆ˜(,)
SELECT Name AS Country,Round(Population/SurfaceArea,1) As "Population Density" FROM Country ORDER BY Population;

--ì„œë¡œ ë‹¤ë¥´ê²Œ ì •ë ¬
SELECT Name,Continent FROM Country ORDER BY Continent DESC,Name;

--ë‹¨ê³„ë³„ë¡œ select
SELECT Name,Code FROM(SELECT Code,Name, Continent FROM COUntry);

--PRIMARY KEY AUTOINCREMENT
PRIMARY KEY AUTOINCREMENT   #PRIMARY KEY = unique not null  #autoincrement  --ìµœê³  ë†’ì€ê±° ë‹¤ìŒìœ¼ë¡œ 1ì”© ì¦ê°€
```
* SQLiteì˜ "ê¸°ì´ˆ ìë£Œí˜•" 5ê°€ì§€
1. NULL : ê²°ì¸¡ì¹˜  
2. INTEGER : 8ë°”ì´íŠ¸ë¡œ í‘œí˜„í•  ìˆ˜ ìˆëŠ” ì •ìˆ˜  
3. REAL : 8ë°”ì´íŠ¸ë¡œ í‘œí˜„í•  ìˆ˜ ìˆëŠ” ì‹¤ìˆ˜  
4. TEXT : ê¸¸ì´ì— ì œì•½ì´ ì—†ëŠ” ë¬¸ìì—´  
5. BLOB : ì…ë ¥ëœ ìë£Œë¥¼ ì›í˜• ê·¸ëŒ€ë¡œ ì €ì¥  
* ë¶€ìš¸í˜• storage classëŠ” ì—†ë‹¤.  
* CHAR(n)ì€ nê°œì˜ ë¬¸ì ê¸¸ì´ë¡œ ê³ ì •ëœ ë¬¸ìì—´ ì˜ë¯¸  
* VARCHAR(n)ì€ ìµœëŒ€ nê°œì˜ ë¬¸ìê¹Œì§€ ìœ ë™ì ì¸ ê¸¸ì´ì˜ ë¬¸ìì—´ ì˜ë¯¸  
```sqlite
--ë°ì´í„° ë² ì´ìŠ¤ & í…Œì´ë¸”ì˜ ìƒì„±ê³¼ ë³€ê²½
CREATE TABLE myTB(a INT, b TEXT);     --ìƒˆë¡­ê²Œ í…Œì´ë¸” ìƒì„±(ë° ì¶”ê°€)
SELECT*FROM sqlite_master WHERE TYPE="table"; --SQLiteì—ì„œ í…Œì´ë¸” ëª©ë¡ í™•ì¸
INSERT INTO myTB VALUES(1,'foo');
SELECT*FROM myTB;
DROP TABLE myTB;  --í…Œì´ë¸” ì‚­ì œ
SELECT*FROM customer; --'customer'í…Œì´ë¸” ì¶œë ¥
CREATE TABLE customer2 AS SELECT id,name,zip from customer; --'customer'ë°”íƒ•ìœ¼ë¡œ 'customer2'ìƒì„±

#í…Œì´ë¸” ìƒì„±ì‹œ ì»¬ëŸ¼ì˜ ìë£Œí˜•ì„ ëª…ì‹œí•  ìˆ˜ ìˆë‹¤. CHAR,VARCHAR = TEXTí˜•
-- CHAR(n) = ê¸¸ì´ ê³ ì •ì , VARCHAR(n) = ìµœëŒ€ ê¸¸ì´ê°€ nê¹Œì§€
CREATE TABLE test(
    id INTEGER,
    name VARCHAR(255),
    address VARCHAR(255),
    city VARCHAR(255),
    state CHAR(2),
    zip CHAR(10)
                    );
INSERT INTO test VALUES(1,"John","Main ST.12","Seattle","WA",92105);
INSERT INTO test VALUES('A',"John","Main ST.123","Seattle","WA",92100); --ì¤‘ë³µë„ ê°€ëŠ¥í•˜ê³ , SQLiteì—ì„œëŠ” ë‹¤ë¥¸ ìë£Œí˜•ì„ ë„£ì–´ë„ ì‘ë™í•œë‹¤.


CREATE TABLE test(
    a INTEGER NOT NULL,    --'a'ì— NULLì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
    b VARCHAR(255)
                  );
INSERT INTO test VALUES(1,"John");
INSERT INTO test(a,b) VALUES (NULL,"DAVID"); --NULLì€ ì•ˆëœë‹¤. ì˜¤ë¥˜
INSERT INTO test(b) VALUES ('PAUL');   --ì˜¤ë¥˜


CREATE TABLE test(
    a INTEGER NOT NULL DEFAULT 0,           --'a'ì—ëŠ” defaultê°’ ì„¤ì •
    b VARCHAR(255) UNIQUE NOT NULL          --'b'ì—ëŠ” ì¤‘ë³µ í—ˆìš©x
                );
INSERT INTO test (a,b) VALUES (3,"SALLY");
INSERT INTO test (b) VALUES('PAUL');        --'a'ì— defaultê°’ 0ì´ ë“¤ì–´ê°„ë‹¤.
INSERT INTO test (a,b) VALUES (NULL,'David');  --ì˜¤ë¥˜
INSERT INTO test VALUES (4,"SALLY");          --ì˜¤ë¥˜, ì¤‘ë³µ í—ˆìš©x


CREATE TABLE test(
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    a VARCHAR(255),
    b VARCHAR(255)  
                );
INSERT INTO test(a,b)VALUES('one','two');    --idë¡œ 1 ìë™ ì‚½ì…
INSERT INTO test VALUES (5,'five','six');
INSERT INTO test(a,b)VALUES('seven','eight');   --idë¡œ 6ìë™ ì‚½ì…  
```
<hr>

# 3ì£¼ì°¨
## <1>
```sqlite
--SQLiteëŠ” ë¶€ìš¸ì´ ì—†ëŠ” ëŒ€ì‹  integerë¡œ ëŒ€ì²´

CREATE TABLE test (
		id INTEGER PRIMARY KEY AUTOINCREMENT,     
		a VARCHAR(255),
    		b VARCHAR(255)
		);
SELECT name FROM sqlite_master WHERE type = 'table';
SELECT*FROM sqlite_sequence;
--sqlite_sequenceì— autoincrementê°€ ì ìš©ëœ ì—´ì˜ ìµœëŒ€ê°’ì´ ì €ì¥
--ë‚˜ì¤‘ì— autoincrementê°€ ì ìš©ë ë•Œ sqlite_sequence+1ì´ ë¶€ì—¬ëœë‹¤.
```
```sqlite
--í…Œì´ë¸”ì„ ìƒì„±í•œ í›„ êµ¬ì¡°ë¥¼ ë°”ê¾¼ë‹¤ëŠ” ê²ƒ = ì—´ì„ ì¶”ê°€í•˜ëŠ” ê±°(í–‰ ì¶”ê°€,ì‚­ì œëŠ” êµ¬ì¡°ë¥¼ ë°”ê¾¼ë‹¤ê³  í•˜ì§€ ì•ŠëŠ”ë‹¤)
CREATE TABLE test (
		id INTEGER PRIMARY KEY AUTOINCREMENT,       
		a VARCHAR(255),
    		b VARCHAR(255)
		);
ALTER TABLE test ADD COLUMN c VARCHAR(100);      --í…Œì´ë¸”ì´ ìƒì„±ëœ í›„ ì—´ì„ ì¶”ê°€í•˜ëŠ” ë²• 
INSERT INTO test VALUES ( 1, "John", "Male", "True");
INSERT INTO test VALUES ( 2, "Mary", "Female", "False");

--sql liteì—ì„œëŠ” ì—´(ì»¬ëŸ¼)ì„ ì‚­ì œí•  ìˆ˜ ì—†ë‹¤. but, testë¥¼ ë°”íƒ•ìœ¼ë¡œ ìƒˆë¡œìš´ í…Œì´ë¸”ì„ ë§Œë“¤ ìˆ˜ ìˆë‹¤.
CREATE TABLE test2 AS SELECT id, a, b FROM test;
DROP TABLE test;
ALTER TABLE test2 RENAME TO test;  --ìƒˆ í…Œì´ë¸” ì´ë¦„ ë³€ê²½
SELECT * FROM test;
```
```sqlite
--BOOLEAN ìë£Œí˜• í‘œí˜„
--0,1ê¹Œì§€ë§Œ ìë£Œí˜•ì„ ë°›ëŠ”ë‹¤.
CREATE TABLE myTB (
		aColumn BOOLEAN NOT NULL CHECK (aColumn IN (0,1))     #0,1ì´ì™¸ì˜ ê°’ì€ rejectë˜ë„ë¡ ì •ì˜
		);
INSERT INTO myTB VALUES (0);	
INSERT INTO myTB VALUES (1);		
INSERT INTO myTB VALUES (2);	  --ERROR
```
```sqlite
--FOREIGN KEYë¥¼ ì‚¬ìš©í•˜ì—¬ í…Œì´ë¸” ì‚¬ì´ì˜ ê´€ê³„ ì„¤ì •.
--ì¼ì¢…ì˜ ì œì•½ (constraint) ì—­í• ì„ í•¨.
CREATE TABLE Franchisee (
  FranchiseeID    INTEGER PRIMARY KEY, 
  FranchiseeName  TEXT NOT NULL
);
INSERT INTO Franchisee VALUES (111,"John");		--ë°ì´í„°ë¥¼ ì…ë ¥í•´ ë‘”ë‹¤.
INSERT INTO Franchisee VALUES (112,"Paul");		
INSERT INTO Franchisee VALUES (113,"David");

--Store í…Œì´ë¸”ì˜ FranchiseeIDì™€ Franchisee í…Œì´ë¸”ì˜ FranchiseeID ì—°ê²°.
CREATE TABLE Store (
  StoreID     INTEGER PRIMARY KEY, 
  StoreName   TEXT NOT NULL,
  FranchiseeID INTEGER NOT NULL,
  FOREIGN KEY(FranchiseeID) REFERENCES Franchisee(FranchiseeID)
);   
INSERT INTO Store VALUES (1,"711 Gangnam", 111);
INSERT INTO Store VALUES (2,"711 Munjeong", 111);
INSERT INTO Store VALUES (3,"711 Suyu", 113);	
INSERT INTO Store VALUES (4,"711 Youido", 114);    --ERROR - 114ëŠ” Franchisee idì— ì—†ë‹¤.
DROP TABLE Franchisee;     --Franchiseeë¨¼ì € ì‚­ì œí•  ìˆ˜ ì—†ë‹¤.(ë°ì´í„°ë¥¼ ë„˜ê²¨ì£¼ê³  ìˆê¸° ë•Œë¬¸)
DROP TABLE Store;          --ë¨¼ì € ì‚­ì œ ê°€ëŠ¥

-- + idëŠ” indexë¡œ uniqueí•˜ë„ë¡ ì‚¬ìš©
```
```sqlite
--í…Œì´ë¸” JOIN
--ì™¼ìª½ í…Œì´ë¸”ê³¼ ì˜¤ë¥¸ìª½ í…Œì´ë¸”ì˜ ê³µí†µ ê°’(ONì¡°ê±´ì— í•´ë‹¹í•˜ëŠ” ê°’)ìœ¼ë¡œ INNER JOIN
SELECT a.name, b.item_id, b.quantity, b.price FROM customer AS a INNER JOIN sale AS b ON a.id = b.customer_id;

--LEFT JOIN   ì™¼ìª½í–‰ì€ ëª¨ë‘ ê°€ì ¸ì˜¤ê³  ì˜¤ë¥¸ìª½ í–‰ì€ ONì¡°ê±´ì— í•´ë‹¹í•˜ëŠ” ê²ƒë§Œ ê°€ì ¸ì˜¨ë‹¤.
SELECT a.name, b.item_id, b.quantity, b.price FROM customer AS a LEFT  JOIN sale AS b ON a.id = b.customer_id;

--SQLiteì—ì„œëŠ” RIGHT JOINê³¼ FULL OUTER JOIN ì§€ì›í•˜ì§€ ì•ŠëŠ”ë‹¤. 
-- -> ë°ì´í„°ì˜ ìœ„ì¹˜ë¥¼ ë°”ê¿”ì¤Œìœ¼ë¡œì¨ left joinë§Œìœ¼ë¡œ right join íš¨ê³¼..

--#ì„¸ê°€ì§€ ì—´ì„ í•©ì¹  ë•Œ
--1. innerjoinì„ ì´ì–´ì„œ
SELECT a.name,b.item_id,b.quantity,b.price,c.name as 'item_name',c.description FROM customer AS a INNER JOIN sale AS b
INNER JOIN item AS c ON a.id=b.customer_id AND c.id=b.item_id;

--2. query ì•ˆì— query 
SELECTì™€ INNER JOIN (SELECT)
--3. viewë¥¼ ì´ìš©
CREATE ViEW myView AS SELECT a.name,b.item_id,b.quantity,b.price FROM customer AS a INNER JOIN sale AS b ON a.id=b.customer_id;
SELECT*FROM myView As a INNER JOIN item AS b ON a.item_id=b.id;
```
```sqlite
--viewëŠ” select queryìì²´ë¥¼ ì €ì¥
CREATE VIEW myView1 AS SELECT Name AS Country, Population / 1000 AS "Pop (1000s)" FROM Country;
CREATE VIEW myView2 AS SELECT Name, Continent, Population FROM Country WHERE Population < 100000 ORDER BY Population DESC;
CREATE VIEW myView3 AS SELECT Name, Continent FROM Country WHERE Name LIKE '_a%';

SELECT * FROM myView1;
SELECT * FROM myView2;
SELECT Name as CountryName FROM myView3;

DROP VIEW myView1;
DROP VIEW myView2;
DROP VIEW myView3;
```
<hr>

## <2>
### SQL í•¨ìˆ˜  
SQLì€ 1ë¶€í„° ì„¼ë‹¤ (ex : pythonì€ 0ë¶€í„°
```sqlite
--ë¬¸ìì—´ í•¨ìˆ˜
--x || y : ë¬¸ìì—´ xì™€ yì—°ê²°
SELECT Code || ' = ' || Name FROM Country;

--LENGTH(x) : ë¬¸ìì—´ xì˜ ê¸¸ì´
SELECT Name, LENGTH(Name) FROM Country;

--SUBSTR(x,n,m) : x=ë¬¸ìì—´, n=ì‹œì‘ ìœ„ì¹˜, m =ë°˜í™˜ ë¬¸ì ê°œìˆ˜
SELECT Name, SUBSTR(Name,1,3) FROM Country;     --ì²«ë²ˆì§¸ ìœ„ì¹˜ì—ì„œ ì„¸ìë¦¬ ë°˜í™˜

--TRIM(x) : ë¬¸ìì—´ xì—ì„œ ìŠ¤í˜ì´ìŠ¤ ì œê±°
--TRIM(x,y) : ë¬¸ìì—´ xì—ì„œ ë¬¸ì y ì œê±°
--LTRIM(),RTRIM() : TRIM()ê³¼ ìœ ì‚¬, ë‹¨ left ë˜ëŠ” rightì— êµ­í•œë˜ê²Œ ë¬¸ì ì œê±°
SELECT TRIM("   <===>    ");   

--UPPER(x),LOWER(x) : ë¬¸ìì—´ xì˜ ëŒ€ë¬¸ìí™” ë˜ëŠ” ì†Œë¬¸ìí™”
SELECT Name, UPPER(Name) FROM Country; 
SELECT Name, LOWER(Name) FROM Country; 

--REPLACE(x,y,z) : ë¬¸ìì—´ xì—ì„œ íŒ¨í„´ yë¥¼ íŒ¨í„´ zë¡œ ëŒ€ì²´
```
```sqlite
--ì§‘ê³„(aggregation)í•˜ì§€ ì•ŠëŠ” ê³„ì‚°ìš© í•¨ìˆ˜ì™€ ì—°ì‚°ì
SELECT ROUND(Population/SurfaceArea,0) AS PopDensity FROM Country;    --ë‚˜ëˆ„ê¸° & ë°˜ì˜¬ë¦¼.
SELECT 7 % 4;				  	      --x%y : ë‚˜ë¨¸ì§€.
SELECT ABS(-123);				  	 --ABS(x) : ì ˆëŒ€ê°’.
SELECT ROUND(123.456789, 3);           --ROUND(x,n) : xì†Œìˆ˜ì  ì´í•˜ nìë¦¬ê¹Œì§€ , ë°˜ì˜¬ë¦¼.

```
```sqlite
--ì§‘ê³„ í•¨ìˆ˜ì™€ ìˆœìœ„ í•¨ìˆ˜ë¥¼ í†µ í„¸ì–´ì„œ ìœˆë„ìš° í•¨ìˆ˜ (Window Function)ë¼ ë¶€ë¥¸ë‹¤.
--ì§‘ê³„ (aggregation) í•¨ìˆ˜.
SELECT COUNT(*) FROM Country;                --í–‰ìˆ˜ ì¹´ìš´íŠ¸.
SELECT COUNT(Population) FROM Country;     --NULLì´ ì•„ë‹Œ Population ê°’ì˜ ê°œìˆ˜.
SELECT Continent, COUNT(*) FROM Country GROUP BY Continent;  	-- ëŒ€ë¥™ë³„ êµ­ê°€ì˜ ìˆ˜.
SELECT Region, COUNT(*) FROM Country GROUP BY Region;  	--Regionë³„ êµ­ê°€ì˜ ìˆ˜.
SELECT COUNT(DISTINCT Continent) FROM Country;     		-- ê³ ìœ í•œ ëŒ€ë¥™ì˜ ê°œìˆ˜. 

--SUM(X) : ê·¸ë£¹ë³„ Xì»¬ëŸ¼ì˜ í•©ì„ êµ¬í•´ì¤€ë‹¤.
--AVG(X) : ê·¸ë£¹ë³„ Xì»¬ëŸ¼ì˜ í‰ê· ì„ êµ¬í•´ì¤€ë‹¤.
SELECT AVG(Population) FROM Country WHERE Region = 'Western Europe';  -- ì„œìœ ëŸ½ ì§€ì—­ì˜ êµ­ê°€ì˜ ì¸êµ¬ í‰ê· .

--MIN(x),MAX(X) : ê·¸ë£¹ë³„ Xì»¬ëŸ¼ì˜ ìµœì†Œê°’, ìµœëŒ€ê°’ ê³„ì‚°
SELECT MIN(Population), MAX(Population) FROM Country WHERE Region = 'Western Europe'; 

```
```sqlite
-- ë‚ ì§œì™€ ì‹œê°„ ê´€ë ¨ í•¨ìˆ˜. 
SELECT DATE('now');		--í˜„ì¬ ë‚ ì§œ.
SELECT TIME('now');		--í˜„ì¬ ì‹œê°. 
SELECT DATETIME('now');		--ë‚ ì§œì™€ ì‹œê°.
SELECT STRFTIME('%Y', 'now');		-- ì—°ë„
SELECT STRFTIME('%m', 'now');	  -- ì›”(1~12)
SELECT STRFTIME('%d', 'now');		-- ì¼
SELECT STRFTIME('%w', 'now');   -- ìš”ì¼(0~6,0=ì¼ìš”ì¼)	 
SELECT STRFTIME('%s', 'now');   -- ì´ˆ
SELECT TIME('now','+9 hour','-30 minute');   --nowë‚˜ datetimeì— +ì™€ -ë¥¼ í•  ìˆ˜ë„ ìˆë‹¤.
```
### pythonì—ì„œ sqlite ì ‘ê·¼
```python
import sqlite3
import pandas as pd
import os
from google.colab import drive
# êµ¬ê¸€ ë“œë¼ì´ë¸Œ ë§ˆìš´íŠ¸.
drive.mount('/content/drive')  # ì ˆì°¨ë¥¼ ë”°ë¼ì„œ í•œë‹¤
# í˜„ í´ë”ì˜ ìœ„ì¹˜ë¥¼ ë³´ì—¬ì¤€ë‹¤.
!pwd        # Linux
from platform import platform
platform()  #platformí™•ì¸ : Linux-5.4.104+-x86_64-with-Ubuntu-18.04-bionic
# ì‘ì—… í´ë”ë¡œ ì´ë™í•œë‹¤.
# ë°ì´í„° íŒŒì¼ì€ ì´ë¯¸ ì˜¬ë ¤ì ¸ ìˆì–´ì•¼ í•œë‹¤.
os.chdir("/content/drive/MyDrive/ê´‘ì¸ì‚¬/01_SQLê³¼ ë°ì´í„° ë² ì´ìŠ¤_ë°°í¬/")
# %cd /content/drive/MyDrive/ê´‘ì¸ì‚¬/01_SQLê³¼ ë°ì´í„° ë² ì´ìŠ¤_ë°°í¬/        #ë””ë ‰í† ë¦¬ ê²½ë¡œì´ë™ 
# í˜„ í´ë”ì˜ ìœ„ì¹˜ë¥¼ ë³´ì—¬ì¤€ë‹¤.
!pwd
# í˜„ í´ë”ì˜ ë‚´ìš©ì„ ë³´ì—¬ì¤€ë‹¤.
!ls
```
```python
# SQLite ì— ì—°ê²° & Cursor ìƒì„±.
os.chdir("../database/")
conn = sqlite3.connect("world.db")
cur = conn.cursor()
# MySQL í–‰ ê°€ì ¸ì˜¤ê¸°.
sql = "SELECT Name, Code, Region, Population FROM Country ORDER BY Population DESC;" #ë¬¸ìì—´
cur.execute(sql);       #ë¬¸ìì—´ì„ ì‹¤ì–´ë³´ë‚´ì„œ ì‹¤í–‰
res = cur.fetchall()      #dataë¥¼ tupleí˜•íƒœë¡œ listì— ì €ì¥
                          #í•œë²ˆ fetchallí•˜ë©´ fetchí•˜ê³  ë‚´ìš©ì´ í´ë¦¬ì–´ëœë‹¤.
# ìë£Œí˜•ì€ List of tuples.
print(type(res))  #<class 'list'>
print(type(res[0]))  #<class 'tuple'>
```
```python
for x in res:
    print(x)

# ('China', 'CHN', 'Eastern Asia', 1277558000)
# ('India', 'IND', 'Southern and Central Asia', 1013662000)
# ('United States', 'USA', 'North America', 278357000)
# ('Indonesia', 'IDN', 'Southeast Asia', 212107000)
# ('Brazil', 'BRA', 'South America', 170115000)
# ('Pakistan', 'PAK', 'Southern and Central Asia', 156483000)
# ('Russian Federation', 'RUS', 'Eastern Europe', 146934000)
# ('Bangladesh', 'BGD', 'Southern and Central Asia', 129155000)
# ('Japan', 'JPN', 'Eastern Asia', 126714000)
# ('Nigeria', 'NGA', 'Western Africa', 111506000)
# ('Mexico', 'MEX', 'Central America', 98881000)
# ('Germany', 'DEU', 'Western Europe', 82164700)

conn.close()
```
```python
# SQLite ì— ì—°ê²° & Cursor ìƒì„±.
os.chdir("../database")       #í˜„ì¬ ë””ë ‰í† ë¦¬ë¥¼ ìƒˆë¡œìš´ ìœ„ì¹˜ì˜ ë””ë ‰í† ë¦¬ë¡œ ë³€ê²½í•œë‹¤.
conn = sqlite3.connect("scratch.db")
cur = conn.cursor()         #ì»¤ì„œëŠ” ë‚´ì¥ SQLë¬¸ì˜ ìˆ˜í–‰ê²°ê³¼ë¡œ ë°˜í™˜ë  ìˆ˜ ìˆëŠ” ë³µìˆ˜ì˜ íŠœí”Œë“¤ì„ ì•¡ì„¸ìŠ¤ í•  ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” ê°œë…

# MySQL í…Œì´ë¸” ìƒì„±.
sql = "CREATE TABLE IF NOT EXISTS test ( a INT, b TEXT, c TEXT );"
cur.execute(sql);     #SQLë¬¸ ì‹¤í–‰
conn.commit();      #ëª¨ë“  ì‘ì—…ì„ ì •ìƒì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê² ë‹¤ê³  í™•ì •í•˜ëŠ” ëª…ë ¹ì–´, ë°ì´í„°ë² ì´ìŠ¤ ìì²´ì— ì €ì¥,ë³€ê²½

# "test" í…Œì´ë¸”ì— í–‰ ì¶”ê°€.
sql = "INSERT INTO test VALUES ( ?, ?, ? );"      # ?ë¥¼ placeholderë¡œ ì‚¬ìš©!
x = [1, "Hello", "World"]                        # ì‚½ì…ë  ë‚´ìš©.
cur.execute(sql,x);                                # ì‹¤í–‰!
conn.commit();

# "test" í…Œì´ë¸”ì— í–‰ ê³„ì† ì¶”ê°€.
sqls = ["INSERT INTO test VALUES ( 2, 'This', 'Right here!' );", 
        "INSERT INTO test ( b, c ) VALUES ( 'That', 'Over there!' );",
        "INSERT INTO test ( a, b, c ) SELECT id, name, description FROM item;"] 
for a_sql in sqls:
    cur.execute(a_sql);
conn.commit();

# í…Œì´ë¸” ë‚´ìš© ë³´ê¸°.
sql = "SELECT * FROM test"
cur.execute(sql);
res = cur.fetchall()    #fetch all -> ë ˆì½”ë“œë¥¼ ë°°ì—´í˜•ì‹ìœ¼ë¡œ ì €ì¥í•´ì¤€ë‹¤.
for x in res:
    print(x)

sql = "DROP TABLE test;"
cur.execute(sql);
conn.commit()
conn.close()
```
```python
##2
#pythonì—ëŠ” SQLiteê°€ ì´ë¯¸ ì„¤ì¹˜ë˜ì–´ ìˆë‹¤.(Colab or Anaconda)
#ì»¤ì„œ(cursor)ê°ì²´ë¥¼ ë§Œë“¤ê³  SQL ì»¤ë§¨ë“œë¥¼ ì‰½ê²Œ ì²˜ë¦¬í•  ìˆ˜ ìˆë‹¤.
import sqlite3
conn=sqlite3.connect('customer.db')    #ê²½ë¡œë¥¼ ì˜ëª» ì ì–´ë„ ì—´ë¦°ë‹¤(ìƒˆë¡œ ìƒì„±ëœë‹¤) ì£¼ì˜!
cur=conn.cursor()                     #ì»¤ì„œ ê°ì²´ cursor ë©”ì„œë“œëŠ” ë‹¨ì¼ ì„ íƒì  ë§¤ê°œ ë³€ìˆ˜ factoryë¥¼ ë°›ì•„ë“¤ì¸ë‹¤.
cur.execute("""CREATE TABLE customers(
  first_name  text, last_name text, email text
)""")                                   #Multi-line
conn.commit()  #ë³€í™”ê°€ ìˆëŠ” ê²½ìš°ë§Œ commit
conn.close()   #ë‹«ì•„ì•¼ë§Œ íŒŒì¼ì´ ì €ì¥ë¨, ë°ì´í„° ë² ì´ìŠ¤ ì—°ê²° ì¢…ë£Œ
```
```python
import sqlite3
conn = sqlite3.connect('customer.db')
curr=conn.cursor()
sql = "INSERT INTO test VALUES (?,?,?);"      #?ë¥¼ placeholderë¡œ ì‚¬ìš©
x = [2,"This","That"]                         #ì‚½ì…ë  í–‰(list ë˜ëŠ” tuple)
cur.execute(sql,x)                            #ì‹¤í–‰
conn.commit()
conn.close()
```
<hr>

## <3>
### SQLite ë°ì´í„° ë² ì´ìŠ¤ì™€ Pandas ë°ì´í„°í”„ë ˆì„
```python
import sqlite3
import pandas as pd
import os
from google.colab import drive
# êµ¬ê¸€ ë“œë¼ì´ë¸Œ ë§ˆìš´íŠ¸.
drive.mount('/content/drive') 
!pwd        # Linux
os.chdir("/content/drive/MyDrive/ê´‘ì¸ì‚¬/01_SQLê³¼ ë°ì´í„° ë² ì´ìŠ¤_ë°°í¬/")
!ls
```
### 1). ë°ì´í„°í”„ë ˆì„ì˜ ë‚´ìš©ì„ ë°ì´í„°ë² ì´ìŠ¤ë¡œ ì˜®ê²¨ë³¸ë‹¤: 
#### ë°ì´í„°í”„ë ˆì„ì„ ê°€ì ¸ì˜¨ë‹¤:
```python
os.chdir("./data")
df = pd.read_csv("data_studentlist_en.csv",header="infer")
nrows = df.shape[0]     #df.shape = (17, 8)
my_header = df.columns
df.head(3)
df.describe()
pd.set_option('precision',2)    #ì†Œìˆ˜ì  ì´í•˜ 2ìë¦¬ê¹Œì§€ë§Œ ë³´ì—¬ì¤€ë‹¤##pandasìì²´ ì„¤ì • ë°”ê¾¸ê¸°
df.describe()       #ë‹¤ì–‘í•œ í†µê³„ëŸ‰ì„ ìš”ì•½í•´ì¤€ë‹¤.
# êµ¬ì¡°ë¥¼ ë³¸ë‹¤.
df.info()
```
#### í…Œì´ë¸” ë‚´ìš© ê°€ì ¸ì™€ ë³´ê¸°:
```python
# SQLite ë°ì´í„° ë² ì´ìŠ¤ ìƒì„±(ë˜ëŠ” ì—°ê²°) & Cursor ìƒì„±.
conn = sqlite3.connect("student.db")                         # ì²˜ìŒ ì‹¤í–‰ì‹œ ì‹ ê·œ ìƒì„±.
cur = conn.cursor()
# SQL í…Œì´ë¸” ìƒì„±.
sql = "CREATE TABLE IF NOT EXISTS studentlist ( name TEXT, gender TEXT, age INT, grade INT, absence TEXT, bloodtype TEXT, height REAL, weight REAL);"
cur.execute(sql);
conn.commit();
# SQL í…Œì´ë¸” ë‚´ìš© í´ë¦¬ì–´.
sql = "DELETE FROM studentlist;"
cur.execute(sql);
conn.commit();
# SQL í…Œì´ë¸” ë‚´ìš© í™•ì¸.
sql = "SELECT * FROM studentlist;"
cur.execute(sql);
res = cur.fetchall();
print(res)
```
#### í•œ í–‰ ì”© ì˜®ê²¨ ë‹´ëŠ”ë‹¤:
```python
# "studentlist" í…Œì´ë¸”ì— í–‰ ì¶”ê°€.
sql = "INSERT INTO studentlist VALUES ( ?, ?, ?, ?, ?, ?, ?, ? );"      # ?ë¥¼ placeholderë¡œ ì‚¬ìš©!
for i in range(nrows):
    x = df.loc[i].values                         # ì‚½ì…ë  ë‚´ìš©.
    x = list(x)
    x[2] = int(x[2])                               # INT64ë¥¼ INTë¡œ ë³€í™˜.
    x[3] = int(x[3])                               # INT64ë¥¼ INTë¡œ ë³€í™˜.
    cur.execute(sql,x);                            # ì‚½ì….  
conn.commit();
# í…Œì´ë¸” ë‚´ìš© ë³´ê¸°.
sql = "SELECT * FROM studentlist"
cur.execute(sql);
res = cur.fetchall()
for x in res:
    print(x)
```
### 2). ë°ì´í„°ë² ì´ìŠ¤ì˜ ë‚´ìš©ì„ ë°ì´í„°í”„ë ˆì„ìœ¼ë¡œ ì˜®ê²¨ë³¸ë‹¤: 
```python
# í…Œì´ë¸” ë‚´ìš© ê°€ì ¸ì˜¨ë‹¤.
sql = "SELECT * FROM studentlist"
cur.execute(sql);
res = cur.fetchall()
res
# ìƒˆë¡œìš´ ë°ì´í„° í”„ë ˆì„ ìƒì„± & í™•ì¸.
df_new = pd.DataFrame(data=res, columns=my_header, index=None)
df_new.head(5)
```
### 3). ë’· ì •ë¦¬:
```python
# í…Œì´ë¸” ì‚­ì œ.
sql = "DROP TABLE studentlist;"
cur.execute(sql);
conn.commit();
conn.close()
```

# 4ì£¼ì°¨
## <1>
#### Jupyter Notebookê³¼ êµ¬ê¸€ Colab ì‚¬ìš©ë²•
#### ë§ˆí¬ë‹¤ìš´
#### ë§¤ì§ì»¤ë§¨ë“œ

## <2>
### í™•ë¥ 
#### í™•ë¥ ì˜ ì •ì˜
* ì‹œí–‰ê³¼ ì‚¬ê±´
  - ì‚¬ê±´, í‘œë³¸ê³µê°„(S)
    - ê·¼ì›ì‚¬ê±´ : í•˜ë‚˜ì˜ ê°’ë§Œì´ ë‚˜ì˜¤ëŠ” ì‚¬ê±´
    - AND, OR, NOT : êµì§‘í•©, í•©ì§‘í•©, ì°¨ì§‘í•©
    - ë°°ë°˜ì‚¬ê±´, ì—¬ì‚¬ê±´

* ìˆ˜í•™ì  í™•ë¥ ì˜ ì •ì˜ : Nì´ í•œ ì‹œí–‰ì— ë”°ë¼ì„œ ì¼ì–´ë‚  ìˆ˜ ìˆëŠ” ëª¨ë“  ê²½ìš°ì˜ ìˆ˜.
Naì´ ì‚¬ê±´ Aê°€ ì¼ì–´ë‚˜ëŠ” ê²½ìš°ì˜ ìˆ˜ì¼ ë•Œ ìˆ˜í•™ì  í™•ë¥ (P(A) = Na/N)  

* í™•ë¥ ì˜ ê¸°ë³¸ì„±ì§ˆ
  - ì„ì˜ì˜ ì‚¬ê±´ Aì— ëŒ€í•œ í™•ë¥ ì€   
  0 <= P(A) <=1 ì„ ì¶©ì¡±í•œë‹¤.
  - ê·¼ì›ì‚¬ê±´ì˜ í™•ë¥  pië¥¼ ëª¨ë‘ ë”í•˜ë©´ 1ì´ ë˜ì–´ì•¼ í•œë‹¤.   
  ì¦‰, í‘œë³¸ê³µê°„ Sì— ëŒ€í•œ í™•ë¥  P(S) = 1ì´ë‹¤.

* í†µê³„ì (ê²½í—˜ì ) í™•ë¥ ì˜ ì •ì˜
  - ì–´ë–¤ ì¡°ê±´ ì•„ë˜ì—ì„œ ì‹¤í—˜ ë˜ëŠ” ê´€ì¸¡í•œ ìë£Œì˜ ì´ìˆ˜ë¥¼ Nì´ë¼ í•˜ê³ , ê·¸ ì¤‘ì—ì„œ ì–´ë–¤ ì‚¬ê±´ Aê°€ ì¼ì–´ë‚œ íšŸìˆ˜ë¥¼ ğ‘ğ´ë¼ í•  ë•Œ ìƒëŒ€ë„ìˆ˜ëŠ” ë‹¤ìŒê³¼ ê°™ì´ ì •ì˜í•œë‹¤:  
ìƒëŒ€ë„ìˆ˜ = ğ‘ğ´ / N
  - ê·¸ëŸ¬ë©´ ì‚¬ê±´ Aê°€ ì¼ì–´ë‚  í†µê³„ì  í™•ë¥ ì€ ë‹¤ìŒê³¼ ê°™ì´ ìƒëŒ€ë„ìˆ˜ì˜ ê·¹í•œì´ë‹¤.  
  í†µê³„ì  í™•ë¥  = lim(ğ‘â†’âˆ) NA/N

#### í™•ë¥ ì˜ ë§ì…ˆ
* OR  
P( ğ´ âˆª ğµ )= ğ‘ƒ (ğ´) + ğ‘ƒ(ğµ) âˆ’ ğ‘ƒ(ğ´ âˆ© ğµ)
* ë§Œì•½ Aì™€ Bê°€ ë™ì‹œì— ì¼ì–´ë‚  ìˆ˜ ì—†ëŠ” 'ë°°ë°˜ì‚¬ê±´'ì¸ ê²½ìš°, ğ‘ƒ(ğ´ âˆ© ğµ) = 0 ì´ë©°  
ğ‘ƒ (ğ´ âˆª ğµ) = ğ‘ƒ (ğ´) + ğ‘ƒ (B)

#### í™•ë¥ ì˜ ê³±ì…ˆ
* ì¡°ê±´ë¶€ í™•ë¥  (Conditional Probability)
  - í™•ë¥ ì´ 0ì´ ì•„ë‹Œ ì‚¬ê±´ Aì™€ Bì— ëŒ€í•´ì„œ ì‚¬ê±´ Aê°€ ì¼ì–´ë‚¬ë‹¤ëŠ” ì „ì œë¡œ ì‚¬ê±´ Bê°€ ì¼ì–´ë‚  í™•ë¥ ì„ ì¡°ê±´ë¶€ í™•ë¥ ì´ë¼ ë¶€ë¥´ë©° ğ‘ƒ(ğµ|ğ´)ì™€ ê°™ì´ í‘œê¸°í•œë‹¤.   
  ğ‘ƒ(ğµ|ğ´) = ğ‘ƒ(ğ´ âˆ© ğµ) / ğ‘ƒ(ğ´)  
  ğ‘ƒ(ğ´ âˆ© ğµ) = ğ‘ƒ(ğµ|ğ´) ğ‘ƒ(ğ´)= ğ‘ƒ(ğ´|ğµ) ğ‘ƒ(B)

* ë² ì´ì¦ˆ ì •ë¦¬ : í™•ë¥ ì˜ ê³±ì…ˆì •ë¦¬ë¥¼ ì´ìš©í•˜ì—¬ ë² ì´ì¦ˆ ì •ë¦¬ë¥¼ ë„ì¶œí•´ ë‚¼ ìˆ˜ ìˆë‹¤.  
  ğ‘ƒ(ğ´|ğµ) ğ‘ƒ(ğµ) = ğ‘ƒ(ğµ|ğ´) ğ‘ƒ(ğ´)
* ë² ì´ì¦ˆ ì •ë¦¬ì˜ í™œìš© P(A|B) = P(B|A)P(A) / P(B|A)P(A) + P(B|A^c)P(A^c)

## <3>
####  ì‹ ìš© ì¹´ë“œ ì‚¬ìš© ê¸°ë¡ EDA. ë¶„ì„
* ìì„¸í•œê±´ ex_credit_eda_colab.ipynb
#### 1. ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì™€ì„œ ì‚´í´ ë³¸ë‹¤.
```python
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import warnings
warnings.filterwarnings('ignore')
%matplotlib inline

df = pd.read_csv("../data/data_credit.csv")
df.shape
df.head(5)
```
#### 2. ë°ì´í„°ë¥¼ ì •ì œí•˜ê³  ê²°ì¸¡ì¹˜ ì²˜ë¦¬ë¥¼ í•œë‹¤.
```python
# ê²°ì¸¡ì¹˜ê°€ ë¶„ëª…íˆ ìˆëŠ” ê²ƒ ê°™ìœ¼ë‹ˆ ì»¬ëŸ¼ë³„ ì§‘ê³„í•´ ë³¸ë‹¤.
df.isnull().sum(axis=0)

# ì¼ì‹œë¶ˆì´ NAë¡œ ì²˜ë¦¬ ë˜ì—ˆìœ¼ë‹ˆ ê²°ì¸¡ì¹˜ë¥¼ 1ë¡œ ì±„ìš´ë‹¤.
df = df.fillna(value=1)
df.head(3)

# ê²°ì¸¡ì¹˜ë¥¼ ë‹¤ì‹œ ì§‘ê³„í•´ ë³¸ë‹¤.
df.isnull().sum(axis=0)

# Installmentsì˜ ìë£Œí˜•ì„ ì •ìˆ˜ë¡œ ë°”ê¾¼ë‹¤.
df["installments"] = df.installments.astype("int32")

# month íŒŒìƒ ë³€ìˆ˜ë¥¼ ë§Œë“ ë‹¤.
df["month"] = df.date.apply( lambda x : x[5:7] )

# hour íŒŒìƒ ë³€ìˆ˜ë¥¼ ë§Œë“ ë‹¤.
df["hour"] = df.time.apply(lambda x : x[:2])

# dateì™€ timeì€ ë” ì´ìƒ ì‚¬ìš©í•˜ì§€ ì•Šê² ìœ¼ë‹ˆ ì œê±°í•œë‹¤.
df.drop(columns=['date','time'], inplace=True)
df.head(3)
```
#### 3. ê°œê°œ ë³€ìˆ˜ë³„ë¡œ íƒìƒ‰í•œë‹¤.
```python
# store_idë³„ ë„ìˆ˜ë¥¼ ì§‘ê³„í•˜ê³  íˆìŠ¤í† ê·¸ë¨ìœ¼ë¡œ ì¶œë ¥í•´ ë³¸ë‹¤.
df.store_id.value_counts().plot.hist(bins=50, color="turquoise",alpha=0.5)
plt.show()
# í° skewë¥¼ ë³´ì´ë¯€ë¡œ log ë³€í™˜í•´ì„œ ë‹¤ì‹œ ì‹œê°í™” í•´ë³¸ë‹¤.
np.log(df.store_id.value_counts()).plot.hist(bins=50, color="turquoise",alpha=0.5)
plt.show()
# ì¤‘ìœ„ìˆ˜ë¥¼ ê³„ì‚°í•´ ë³¸ë‹¤.
freq1 = df.store_id.value_counts() 
print(np.median(freq1))
# Top store_idë¥¼ ë³¸ë‹¤.
freq1.sort_values(ascending = False)[:10]
```
#### 4. ìˆ˜ì¹˜í˜• ë³€ìˆ˜ 1ê°œ + ëª…ëª©í˜• ë³€ìˆ˜ 1ê°œë¥¼ ì¡°í•©í•œ íƒìƒ‰.
```python
# store_id ë³„ ê²°ì œ ê¸ˆì•¡.
# í‰ê·  ê¸ˆì•¡ ë­í‚¹ top 10.
df.groupby("store_id").amount.mean().sort_values(ascending=False)[:10]
# Pivot table ë°©ì‹ìœ¼ë¡œ ë‹¤ì‹œ í•´ë³¸ë‹¤.
pd.pivot_table(df, index = "store_id", values="amount", aggfunc = np.mean).sort_values(by="amount", ascending=False)[:10]
# ì´ ê¸ˆì•¡ ë­í‚¹ top 10.
df.groupby("store_id").amount.sum().sort_values(ascending=False)[:10]
# Pivot table ë°©ì‹ìœ¼ë¡œ ë‹¤ì‹œ í•´ë³¸ë‹¤.
pd.pivot_table(df, index = "store_id", values="amount", aggfunc = np.sum).sort_values(by="amount", ascending=False)[:10]
```
#### 5. ìˆ˜ì¹˜í˜• ë³€ìˆ˜ 1ê°œ + ëª…ëª©í˜• ë³€ìˆ˜ 2ê°œë¥¼ ì¡°í•©í•œ íƒìƒ‰.
```python
# ì›”ë³„ ì‹œê°„ëŒ€ë³„ ë§¤ì¶œ ì¶”ì´.
# í‰ê· .
df2 = pd.pivot_table(df, index="hour", columns="month", values = "amount", aggfunc=np.mean)
df2
# ì‹œê°í™”.
df2.plot()
plt.show()
```
#### 6. ë“±ê¸‰í™”.
```python
# store_idë³„ total ê²°ì œ ê¸ˆì•¡ì— ì˜í•œ 3 ë“±ê¸‰ ë¶„ë¥˜. HINT: pd.qcut() ì‚¬ìš©.
ser = df.groupby("store_id").amount.sum()
ser2 = pd.qcut(ser,3,labels=['Low', 'Medium', 'High'])                      # qcut() í•¨ìˆ˜ ì‚¬ìš©!
combo = pd.DataFrame({"Store ID":ser.index, "Amount":ser.values, "Category":ser2.values})
combo.head(10)
# ë“±ê¸‰ë³„ í‰ê· .
combo.groupby("Category")["Amount"].mean()
```


<hr>